/**
 * jquery.Jcrop.min.js v0.9.12 (build:20130202)
 * jQuery Image Cropping Plugin - released under MIT License
 * Copyright (c) 2008-2013 Tapmodo Interactive LLC
 * https://github.com/tapmodo/Jcrop
 */
(function(n){n.Jcrop=function(t,i){function c(n){return Math.round(n)+"px"}function ut(n){return r.baseClass+"-"+n}function wi(){return n.fx.step.hasOwnProperty("backgroundColor")}function ft(t){var i=n(t).offset();return[i.left,i.top]}function g(n){return[n.pageX-w[0],n.pageY-w[1]]}function ii(t){typeof t!="object"&&(t={}),r=n.extend(r,t),n.each(["onChange","onSelect","onRelease","onDblClick"],function(n,t){typeof r[t]!="function"&&(r[t]=function(){})})}function ri(n,t,i){if(w=ft(f),p.setCursor(n==="move"?n:n+"-resize"),n==="move")return p.activateHandlers(ki(t),pt,i);var u=s.getFixed(),r=ui(n),e=s.getCorner(ui(r));s.setPressed(s.getCorner(r)),s.setCurrent(e),p.activateHandlers(bi(n,u),pt,i)}function bi(n,t){return function(i){if(r.aspectRatio)switch(n){case"e":i[1]=t.y+1;break;case"w":i[1]=t.y+1;break;case"n":i[0]=t.x+1;break;case"s":i[0]=t.x+1}else switch(n){case"e":i[1]=t.y2;break;case"w":i[1]=t.y2;break;case"n":i[0]=t.x2;break;case"s":i[0]=t.x2}s.setCurrent(i),u.update()}}function ki(n){var t=n;return bt.watchKeys(),function(n){s.moveOffset([n[0]-t[0],n[1]-t[1]]),t=n,u.update()}}function ui(n){switch(n){case"n":return"sw";case"s":return"nw";case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function fi(n){return function(t){return r.disabled?!1:n==="move"&&!r.allowMove?!1:(w=ft(f),rt=!0,ri(n,g(t)),t.stopPropagation(),t.preventDefault(),!1)}}function ei(t,i,u){var o=r.parentDiv.length===0?t.width():n(r.parentDiv).width(),s=r.parentDiv.length===0?t.height():n(r.parentDiv).height(),f=o,e=s;f>i&&i>0&&(f=i,e=i/o*s),e>u&&u>0&&(e=u,f=u/s*o),l=o/f,a=s/e,t.width(f).height(e)}function et(n){return{x:n.x*l,y:n.y*a,x2:n.x2*l,y2:n.y2*a,w:n.w*l,h:n.h*a}}function pt(){var n=s.getFixed();n.w>r.minSelect[0]&&n.h>r.minSelect[1]?(u.enableHandles(),u.done()):u.release(),p.setCursor(r.allowSelect?"crosshair":"default")}function oi(n){if(r.disabled||!r.allowSelect)return!1;rt=!0,w=ft(f),u.disableHandles(),p.setCursor("crosshair");var t=g(n);return s.setPressed(t),u.update(),p.activateHandlers(di,pt,n.type.substring(0,5)==="touch"),bt.watchKeys(),n.stopPropagation(),n.preventDefault(),!1}function di(n){s.setCurrent(n),u.update()}function si(){var t=n("<div><\/div>").addClass(ut("tracker"));return ni&&t.css({opacity:0,backgroundColor:"white"}),t}function gi(n){$div.removeClass().addClass(ut("holder")).addClass(n)}function nr(n,t){function b(){window.setTimeout(k,d)}var c=n[0]/l,y=n[1]/a,p=n[2]/l,w=n[3]/a,k;if(!wt){var o=s.flipCoords(c,y,p,w),h=s.getFixed(),e=[h.x,h.y,h.x2,h.y2],i=e,d=r.animationDelay,g=o[0]-e[0],nt=o[1]-e[1],tt=o[2]-e[2],it=o[3]-e[3],f=0,rt=r.swingSpeed;c=i[0],y=i[1],p=i[2],w=i[3],u.animMode(!0),k=function(){return function(){f+=(100-f)/rt,i[0]=Math.round(c+f/100*g),i[1]=Math.round(y+f/100*nt),i[2]=Math.round(p+f/100*tt),i[3]=Math.round(w+f/100*it),f>=99.8&&(f=100),f<100?(vi(i),b()):(u.done(),u.animMode(!1),typeof t=="function"&&t.call(v))}}(),b()}}function ai(n){vi([n[0]/l,n[1]/a,n[2]/l,n[3]/a]),r.onSelect.call(v,et(s.getFixed())),u.enableHandles()}function vi(n){s.setPressed([n[0],n[1]]),s.setCurrent([n[2],n[3]]),u.update()}function tr(){return et(s.getFixed())}function ir(){return s.getFixed()}function rr(n){ii(n),dt()}function yi(){r.disabled=!0,u.disableHandles(),u.setCursor("default"),p.setCursor("default")}function pi(){r.disabled=!1,dt()}function ur(){u.done(),p.activateHandlers(null,null)}function fr(){$div.remove(),h.show(),h.css("visibility","visible"),n(t).removeData("Jcrop")}function er(t,i){u.release(),yi();var s=new Image;s.onload=function(){var u=s.width,h=s.height,c=r.boxWidth,l=r.boxHeight;f.width(u).height(h),f.attr("src",t),b.attr("src",t),ei(f,c,l),o=r.parentDiv.length===0?f.width():n(r.parentDiv).width(),e=r.parentDiv.length===0?f.height():n(r.parentDiv).height(),b.width(o).height(e),k.width(o+it*2).height(e+it*2),$div.width(o).height(e),d.resize(o,e),pi(),typeof i=="function"&&i.call(v)},s.src=t}function kt(n,t,i){var u=t||r.bgColor;r.bgFade&&wi()&&r.fadeTime&&!i?n.animate({backgroundColor:u},{queue:!1,duration:r.fadeTime}):n.css("backgroundColor",u)}function dt(n){r.allowResize?n?u.enableOnly():u.enableHandles():u.disableHandles(),p.setCursor(r.allowSelect?"crosshair":"default"),u.setCursor(r.allowMove?"move":"default"),r.hasOwnProperty("trueSize")&&(l=r.trueSize[0]/o,a=r.trueSize[1]/e),r.hasOwnProperty("setSelect")&&(ai(r.setSelect),u.done(),delete r.setSelect),d.refresh(),r.bgColor!=ci&&(kt(r.shade?d.getShades():$div,r.shade?r.shadeColor||r.bgColor:r.bgColor),ci=r.bgColor),ot!=r.bgOpacity&&(ot=r.bgOpacity,r.shade?d.refresh():u.setBgOpacity(ot)),st=r.maxSize[0]||0,ht=r.maxSize[1]||0,ct=r.minSize[0]||0,lt=r.minSize[1]||0,r.hasOwnProperty("outerImage")&&(f.attr("src",r.outerImage),delete r.outerImage),u.refresh()}var r=n.extend({},n.Jcrop.defaults),w,gt=navigator.userAgent.toLowerCase(),ni=/msie/.test(gt),ti=/msie [1-6]\./.test(gt),vt,f,o,e,v;typeof t!="object"&&(t=n(t)[0]),typeof i!="object"&&(i={}),ii(i);var at={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0},h=n(t),hi=!0;r.parentDiv.length===0?t.tagName=="IMG"?(h[0].width!=0&&h[0].height!=0?(h.width(h[0].width),h.height(h[0].height)):(vt=new Image,vt.src=h[0].src,h.width(vt.width),h.height(vt.height)),f=h.clone().removeAttr("id").css(at).show(),f.width(h.width()),f.height(h.height()),h.after(f).hide()):(f=h.css(at).show(),hi=!1,r.shade===null&&(r.shade=!0)):(h.width(n(r.parentDiv).width()),h.height(n(r.parentDiv).height()),f=h.clone().removeAttr("id").css(at).show(),f.width(n(r.parentDiv).width()),f.height(n(r.parentDiv).height()),h.after(f).hide()),ei(f,r.boxWidth,r.boxHeight),o=r.parentDiv.length===0?f.width():n(r.parentDiv).width(),e=r.parentDiv.length===0?f.height():n(r.parentDiv).height(),$div=n("<div />").width(o).height(e).addClass(ut("holder")).css({position:"relative",backgroundColor:r.bgColor}).insertAfter(h).append(f),r.addClass&&$div.addClass(r.addClass);var b=n("<div />"),yt=n("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),nt=n("<div />").width("100%").height("100%").css("zIndex",320),tt=n("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var n=s.getFixed();r.onDblClick.call(v,n)}).insertBefore(f).append(yt,nt);hi&&(b=n("<img />").attr("src",f.attr("src")).css(at).width(o).height(e),yt.append(b)),ti&&tt.css({overflowY:"hidden"});var it=r.boundary,k=si().width(o+it*2).height(e+it*2).css({position:"absolute",top:c(-it),left:c(-it),zIndex:290}).mousedown(oi),ci=r.bgColor,ot=r.bgOpacity,st,ht,ct,lt,l,a,rt,wt,li;w=ft(f);var y=function(){function n(){var i={},u=["touchstart","touchmove","touchend"],f=document.createElement("div"),t,n,r;try{for(t=0;t<u.length;t++)n=u[t],n="on"+n,r=n in f,r||(f.setAttribute(n,"return;"),r=typeof f[n]=="function"),i[u[t]]=r;return i.touchstart&&i.touchend&&i.touchmove}catch(e){return!1}}function t(){return r.touchSupport===!0||r.touchSupport===!1?r.touchSupport:n()}return{createDragger:function(n){return function(t){return r.disabled?!1:n==="move"&&!r.allowMove?!1:(w=ft(f),rt=!0,ri(n,g(y.cfilter(t)),!0),t.stopPropagation(),t.preventDefault(),!1)}},newSelection:function(n){return oi(y.cfilter(n))},cfilter:function(n){return n.pageX=n.originalEvent.changedTouches[0].pageX,n.pageY=n.originalEvent.changedTouches[0].pageY,n},isSupported:n,support:t()}}(),s=function(){function p(r){r=v(r),u=n=r[0],i=t=r[1]}function w(n){n=v(n),s=n[0]-u,h=n[1]-i,u=n[0],i=n[1]}function b(){return[s,h]}function k(r){var f=r[0],s=r[1];0>n+f&&(f-=f+n),0>t+s&&(s-=s+t),e<i+s&&(s+=e-(i+s)),o<u+f&&(f+=o-(u+f)),n+=f,u+=f,t+=s,i+=s}function d(n){var t=c();switch(n){case"ne":return[t.x2,t.y];case"nw":return[t.x,t.y];case"se":return[t.x2,t.y2];case"sw":return[t.x,t.y2]}}function c(){if(!r.aspectRatio)return g();var c=r.aspectRatio,b=r.minSize[0]/l,w=r.maxSize[0]/l,nt=r.maxSize[1]/a,k=u-n,d=i-t,tt=Math.abs(k),it=Math.abs(d),rt=tt/it,s,h,v,p;return w===0&&(w=o*10),nt===0&&(nt=e*10),rt<c?(h=i,v=it*c,s=k<0?n-v:v+n,s<0?(s=0,p=Math.abs((s-n)/c),h=d<0?t-p:p+t):s>o&&(s=o,p=Math.abs((s-n)/c),h=d<0?t-p:p+t)):(s=u,p=tt/c,h=d<0?t-p:t+p,h<0?(h=0,v=Math.abs((h-t)*c),s=k<0?n-v:v+n):h>e&&(h=e,v=Math.abs(h-t)*c,s=k<0?n-v:v+n)),s>n?(s-n<b?s=n+b:s-n>w&&(s=n+w),h=h>t?t+(s-n)/c:t-(s-n)/c):s<n&&(n-s<b?s=n-b:n-s>w&&(s=n-w),h=h>t?t+(n-s)/c:t-(n-s)/c),s<0?(n-=s,s=0):s>o&&(n-=s-o,s=o),h<0?(t-=h,h=0):h>e&&(t-=h-e,h=e),y(f(n,t,s,h))}function v(n){return n[0]<0&&(n[0]=0),n[1]<0&&(n[1]=0),n[0]>o&&(n[0]=o),n[1]>e&&(n[1]=e),[Math.round(n[0]),Math.round(n[1])]}function f(n,t,i,r){var u=n,f=i,e=t,o=r;return i<n&&(u=i,f=n),r<t&&(e=r,o=t),[u,e,f,o]}function g(){var s=u-n,h=i-t,r;return st&&Math.abs(s)>st&&(u=s>0?n+st:n-st),ht&&Math.abs(h)>ht&&(i=h>0?t+ht:t-ht),lt/a&&Math.abs(h)<lt/a&&(i=h>0?t+lt/a:t-lt/a),ct/l&&Math.abs(s)<ct/l&&(u=s>0?n+ct/l:n-ct/l),n<0&&(u-=n,n-=n),t<0&&(i-=t,t-=t),u<0&&(n-=u,u-=u),i<0&&(t-=i,i-=i),u>o&&(r=u-o,n-=r,u-=r),i>e&&(r=i-e,t-=r,i-=r),n>o&&(r=n-e,i-=r,t-=r),t>e&&(r=t-e,i-=r,t-=r),y(f(n,t,u,i))}function y(n){return{x:n[0],y:n[1],x2:n[2],y2:n[3],w:n[2]-n[0],h:n[3]-n[1]}}var n=0,t=0,u=0,i=0,s,h;return{flipCoords:f,setPressed:p,setCurrent:w,getOffset:b,moveOffset:k,getCorner:d,getFixed:c}}(),d=function(){function g(n,t){i.left.css({height:c(t)}),i.right.css({height:c(t)})}function v(){return y(s.getFixed())}function y(n){i.top.css({left:c(n.x),width:c(n.w),height:c(n.y)}),i.bottom.css({top:c(n.y2),left:c(n.x),width:c(n.w),height:c(e-n.y2)}),i.right.css({left:c(n.x2),width:c(o-n.x2)}),i.left.css({width:c(n.x)})}function l(){return n("<div />").css({position:"absolute",backgroundColor:r.shadeColor||r.bgColor}).appendTo(t)}function p(){h||(h=!0,t.insertBefore(f),v(),u.setBgOpacity(1,0,1),b.hide(),w(r.shadeColor||r.bgColor,1),u.isAwake()?a(r.bgOpacity,1):a(1,1))}function w(n,t){kt(d(),n,t)}function k(){h&&(t.remove(),b.show(),h=!1,u.isAwake()?u.setBgOpacity(r.bgOpacity,1,1):(u.setBgOpacity(1,1,1),u.disableHandles()),kt($div,0,1))}function a(n,i){h&&(r.bgFade&&!i?t.animate({opacity:1-n},{queue:!1,duration:r.fadeTime}):t.css({opacity:1-n}))}function nt(){r.shade?p():k(),u.isAwake()&&a(r.bgOpacity)}function d(){return t.children()}var h=!1,t=n("<div />").css({position:"absolute",zIndex:240,opacity:0}),i={top:l(),left:l().height(e),right:l().height(e),bottom:l()};return{update:v,updateRaw:y,getShades:d,setBgColor:w,enable:p,disable:k,resize:g,refresh:nt,opacity:a}}(),u=function(){function st(t){var i=n("<div />").css({position:"absolute",opacity:r.borderOpacity}).addClass(ut(t));return yt.append(i),i}function l(t,i){var r=n("<div />").mousedown(fi(t)).css({cursor:t+"-resize",position:"absolute",zIndex:i}).addClass("ord-"+t);return y.support&&r.bind("touchstart.jcrop",y.createDragger(t)),nt.append(r),r}function ht(n){var t=r.handleSize,i=l(n,h++).css({opacity:r.handleOpacity}).addClass(ut("handle"));return t&&i.width(t).height(t),i}function ct(n){return l(n,h++).addClass("jcrop-dragbar")}function lt(n){for(var t=0;t<n.length;t++)ft[n[t]]=ct(n[t])}function at(n){for(var t,i=0;i<n.length;i++){switch(n[i]){case"n":t="hline";break;case"s":t="hline bottom";break;case"e":t="vline right";break;case"w":t="vline"}it[n[i]]=st(t)}}function vt(n){for(var t=0;t<n.length;t++)rt[n[t]]=ht(n[t])}function pt(n,t){r.shade||b.css({top:c(-t),left:c(-n)}),tt.css({top:c(t),left:c(n)})}function bt(n,t){tt.width(Math.round(n)).height(Math.round(t))}function a(){var n=s.getFixed();s.setPressed([n.x,n.y]),s.setCurrent([n.x2,n.y2]),p()}function p(n){if(t)return w(n)}function w(n){var i=s.getFixed();bt(i.w,i.h),pt(i.x,i.y),r.shade&&d.updateRaw(i),t||kt(),n?r.onSelect.call(v,et(i)):r.onChange.call(v,et(i))}function o(n,i,u){(t||i)&&(r.bgFade&&!u?f.animate({opacity:n},{queue:!1,duration:r.fadeTime}):f.css("opacity",n))}function kt(){tt.show(),r.shade?d.opacity(ot):o(ot,!0),t=!0}function dt(){u(),tt.hide(),r.shade?d.opacity(1):o(1),t=!1,r.onRelease.call(v)}function gt(){i&&nt.show()}function k(){return i=!0,r.allowResize?(nt.show(),!0):void 0}function u(){i=!1,nt.hide()}function g(n){n?(wt=!0,u()):(wt=!1,k())}function ni(){g(!1),a()}var t,h=370,it={},rt={},ft={},i=!1,e;return r.dragEdges&&n.isArray(r.createDragbars)&&lt(r.createDragbars),n.isArray(r.createHandles)&&vt(r.createHandles),r.drawBorders&&n.isArray(r.createBorders)&&at(r.createBorders),n(document).bind("touchstart.jcrop-ios",function(t){n(t.currentTarget).hasClass("jcrop-tracker")&&t.stopPropagation()}),e=si().mousedown(fi("move")).css({cursor:"move",position:"absolute",zIndex:360}),y.support&&e.bind("touchstart.jcrop",y.createDragger("move")),yt.append(e),u(),{updateVisible:p,update:w,release:dt,refresh:a,isAwake:function(){return t},setCursor:function(n){e.css("cursor",n)},enableHandles:k,enableOnly:function(){i=!0},showHandles:gt,disableHandles:u,animMode:g,setBgOpacity:o,done:ni}}(),p=function(){function c(t){k.css({zIndex:450}),t?n(document).bind("touchmove.jcrop",p).bind("touchend.jcrop",w):o&&n(document).bind("mousemove.jcrop",h).bind("mouseup.jcrop",i)}function l(){k.css({zIndex:290}),n(document).unbind(".jcrop")}function h(n){return t(g(n)),!1}function i(n){return n.preventDefault(),n.stopPropagation(),rt&&(rt=!1,e(g(n)),u.isAwake()&&r.onSelect.call(v,et(s.getFixed())),l(),t=function(){},e=function(){}),!1}function a(n,i,r){return rt=!0,t=n,e=i,c(r),!1}function p(n){return t(g(y.cfilter(n))),!1}function w(n){return i(y.cfilter(n))}function b(n){k.css("cursor",n)}var t=function(){},e=function(){},o=r.trackDocument;return o||k.mousemove(h).mouseup(i).mouseout(i),f.before(k),{activateHandlers:a,setCursor:b}}(),bt=function(){function o(){r.keySupport&&(t.show(),t.focus())}function h(){t.hide()}function i(n,t,i){r.allowMove&&(s.moveOffset([t,i]),u.updateVisible(!0)),n.preventDefault(),n.stopPropagation()}function c(n){if(n.ctrlKey||n.metaKey)return!0;li=n.shiftKey?!0:!1;var t=li?10:1;switch(n.keyCode){case 37:i(n,-t,0);break;case 39:i(n,t,0);break;case 38:i(n,0,-t);break;case 40:i(n,0,t);break;case 27:r.allowSelect&&u.release();break;case 9:return!0}return!1}var t=n('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),e=n("<div />").css({position:"absolute",overflow:"hidden"}).append(t);return r.keySupport&&(t.keydown(c).blur(h),ti||!r.fixedSupport?(t.css({position:"absolute",left:"-20px"}),e.append(t).insertBefore(f)):t.insertBefore(f)),{watchKeys:o}}();return y.support&&k.bind("touchstart.jcrop",y.newSelection),nt.hide(),dt(!0),v={setImage:er,animateTo:nr,setSelect:ai,setOptions:rr,tellSelect:tr,tellScaled:ir,setClass:gi,disable:yi,enable:pi,cancel:ur,release:u.release,destroy:fr,focus:bt.watchKeys,getBounds:function(){return[o*l,e*a]},getWidgetSize:function(){return[o,e]},getScaleFactor:function(){return[l,a]},getOptions:function(){return r},ui:{holder:$div,selection:tt}},ni&&$div.bind("selectstart",function(){return!1}),h.data("Jcrop",v),v},n.fn.Jcrop=function(t,i){var r;return this.each(function(){if(n(this).data("Jcrop")){if(t==="api")return n(this).data("Jcrop");n(this).data("Jcrop").setOptions(t)}else this.tagName=="IMG"?n.Jcrop.Loader(this,function(){n(this).css({display:"block",visibility:"hidden"}),r=n.Jcrop(this,t),n.isFunction(i)&&i.call(r)}):(n(this).css({display:"block",visibility:"hidden"}),r=n.Jcrop(this,t),n.isFunction(i)&&i.call(r))}),this},n.Jcrop.Loader=function(t,i,r){function e(){f.complete?(u.unbind(".jcloader"),n.isFunction(i)&&i.call(f)):window.setTimeout(e,50)}var u=n(t),f=u[0];u.bind("load.jcloader",e).bind("error.jcloader",function(){u.unbind(".jcloader"),n.isFunction(r)&&r.call(f)}),f.complete&&n.isFunction(i)&&(u.unbind(".jcloader"),i.call(f))},n.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:null,aspectRatio:0,keySupport:!0,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,parentDiv:"",minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}})(jQuery)