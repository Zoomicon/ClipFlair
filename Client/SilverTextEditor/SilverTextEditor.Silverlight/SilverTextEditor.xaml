<UserControl
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="d"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" d:DesignHeight="600" d:DesignWidth="905" 
    xmlns:controls="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls"
    xmlns:System_Windows_Controls_Primitives="clr-namespace:System.Windows.Controls.Primitives;assembly=System.Windows.Controls"
    xmlns:local="clr-namespace:SilverTextEditor;assembly=SilverTextEditor"
    xmlns:res="clr-namespace:SilverTextEditor.Resources;assembly=SilverTextEditor"
    x:Class="SilverTextEditor.SilverTextEditor"
    FontFamily="Calibri">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/SilverTextEditor;component/Themes/Generic.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>

    <Grid x:Name="LayoutRoot" Background="#FF7297C5">
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup x:Name="DragStates">
                <VisualStateGroup.Transitions>
                    <VisualTransition GeneratedDuration="0:0:0.3">
                        <VisualTransition.GeneratedEasingFunction>
                            <CircleEase EasingMode="EaseIn"/>
                        </VisualTransition.GeneratedEasingFunction>
                    </VisualTransition>
                </VisualStateGroup.Transitions>
                <VisualState x:Name="Normal"/>
                <VisualState x:Name="DragOver">
                    <Storyboard>
                        <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Control.Background).(SolidColorBrush.Color)" Storyboard.TargetName="rtb">
                            <EasingColorKeyFrame KeyTime="0" Value="#FFFFF7D1"/>
                        </ColorAnimationUsingKeyFrames>
                    </Storyboard>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
        <Border x:Name="ApplicationBorder" MaxWidth="900" Margin="0,0,0,0" Grid.RowSpan="1" BorderThickness="1" BorderBrush="#FF646464">
            <Grid Name="MainGrid">
                <Grid.RowDefinitions>
                    <RowDefinition Height="93" />
                    <RowDefinition/>
                </Grid.RowDefinitions>

                <Rectangle Height="94" Grid.RowSpan="2" VerticalAlignment="Top" Stroke="#FF8B9097" Fill="#FFDDEFFA"/>
                <Grid Name="ToolBarGrid" Margin="3,3,3,1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="27"/>
                        <RowDefinition/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="102"/>
                        <ColumnDefinition Width="176"/>
                        <ColumnDefinition Width="184"/>
                        <ColumnDefinition Width="73"/>
                        <ColumnDefinition Width="106"/>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="90"/>
                    </Grid.ColumnDefinitions>

                    <Rectangle Margin="0,-26,0,2" Fill="{StaticResource MenuDividerBrush}" Grid.Column="0" Grid.Row="1" RadiusX="2" RadiusY="2" Stroke="#FFA5BED4"/>
                    <Rectangle Margin="2,-26,0,2" Fill="{StaticResource MenuDividerBrush}" Grid.Column="1" Grid.Row="1" RadiusX="2" RadiusY="2" Stroke="#FFA5BED4"/>
                    <Rectangle Margin="2,-26,0,2" Fill="{StaticResource MenuDividerBrush}" Grid.Column="2" Grid.Row="1" RadiusX="2" RadiusY="2" Stroke="#FFA5BED4"/>
                    <Rectangle Margin="2,-26,0,2" Fill="{StaticResource MenuDividerBrush}" Grid.Column="3" Grid.Row="1" RadiusX="2" RadiusY="2" Stroke="#FFA5BED4"/>
                    <Rectangle Margin="2,-26,0,2" Fill="{StaticResource MenuDividerBrush}" Grid.Column="4" Grid.Row="1" RadiusX="2" RadiusY="2" Stroke="#FFA5BED4"/>
                    <Rectangle Margin="2,-26,0,2" Fill="{StaticResource MenuDividerBrush}" Grid.Column="5" Grid.Row="1" RadiusX="2" RadiusY="2" Stroke="#FFA5BED4"/>
                    <Rectangle Margin="2,-26,0,2" Fill="{StaticResource MenuDividerBrush}" Grid.Column="6" Grid.Row="1" RadiusX="2" RadiusY="2" Stroke="#FFA5BED4"/>
                    <Rectangle Margin="2,-26,0,2" Fill="{StaticResource MenuDividerBrush}" Grid.Column="7" Grid.Row="1" RadiusX="2" RadiusY="2" Stroke="#FFA5BED4"/>

                    <!--Clipboard Toolbar Section-->
                    <Button x:Name="btnPaste" Click="btnPaste_Click" Margin="17,-22,33,24" Grid.Row="1" HorizontalAlignment="Left">
                        <ToolTipService.ToolTip>
                            <ToolTip FontSize="16" Content="Paste"/>
                        </ToolTipService.ToolTip>
                        <Image Source="Images/Paste_big.png" Height="32" Width="29"/>
                    </Button>
                    <Button x:Name="btnCut" Click="btnCut_Click" Margin="0,0,17,0" HorizontalAlignment="Right" Width="22" VerticalAlignment="Bottom">
                        <ToolTipService.ToolTip>
                            <ToolTip FontSize="16" Content="Cut"/>
                        </ToolTipService.ToolTip>
                        <Image Source="Images/Cut.png" d:IsLocked="True"/>
                    </Button>
                    <Button x:Name="btnCopy" Click="btnCopy_Click" Margin="0,5,17,0" VerticalAlignment="Top" Grid.Row="1" HorizontalAlignment="Right" Width="22">
                        <ToolTipService.ToolTip>
                            <ToolTip FontSize="16" Content="Copy"/>
                        </ToolTipService.ToolTip>
                        <Image Source="Images/Copy.png" d:IsLocked="True"/>
                    </Button>

                    <!--Fonts Toolbar Section-->
                    <ComboBox x:Name="cmbFonts" FontFamily="{Binding SelectedItem.FontFamily, RelativeSource={RelativeSource Self}}" FontSize="{Binding SelectedItem.FontSize, RelativeSource={RelativeSource Self}}" SelectionChanged="cmbFonts_SelectionChanged" Grid.Column="1" Margin="6,0,55,0" Height="22" VerticalAlignment="Bottom" >
                        <ComboBoxItem Content="Arial" Tag="Arial" FontFamily="Arial" FontSize="12"/>
                        <ComboBoxItem Content="Arial Black" Tag="Arial Black" FontFamily="Arial Black" FontSize="12"/>
                        <ComboBoxItem Content="Calibri" Tag="Calibri" FontFamily="Calibri" IsSelected="True" FontSize="14"/>
                        <ComboBoxItem Content="Comic Sans MS" Tag="Comic Sans MS" FontFamily="Comic Sans MS" FontSize="12"/>
                        <ComboBoxItem Content="Courier New" Tag="Courier New" FontFamily="Courier New" FontSize="12"/>
                        <ComboBoxItem Content="Georgia" Tag="Georgia" FontFamily="Georgia" FontSize="12"/>
                        <ComboBoxItem Content="Lucida Sans Unicode" Tag="Lucida Sans Unicode" FontFamily="Lucida Sans Unicode" FontSize="12"/>
                        <ComboBoxItem Content="Portable User Interface" Tag="{x:Null}" FontFamily="Portable User Interface" FontSize="12"/>
                        <ComboBoxItem Content="Times New Roman" Tag="Times New Roman" FontFamily="Times New Roman" FontSize="12"/>
                        <ComboBoxItem Content="Trebuchet MS" Tag="Trebuchet MS" FontFamily="Trebuchet MS" FontSize="12"/>
                        <ComboBoxItem Content="Verdana" Tag="Verdana" FontFamily="Verdana" FontSize="12"/>
                        <ComboBoxItem Content="Webdings" Tag="Webdings" FontSize="12"/>
                    </ComboBox>

                    <ComboBox x:Name="cmbFontSizes" Width="44" FontSize="14" SelectionChanged="cmbFontSizes_SelectionChanged" HorizontalAlignment="Right" Margin="0,0,6,0" Grid.Column="1" Height="22" VerticalAlignment="Bottom">
                        <ComboBoxItem Content="8" Tag="8"/>
                        <ComboBoxItem Content="9" Tag="9"/>
                        <ComboBoxItem Content="10" Tag="10"/>
                        <ComboBoxItem Content="11" Tag="11"/>
                        <ComboBoxItem Content="12" Tag="12"/>
                        <ComboBoxItem Content="14" Tag="14"/>
                        <ComboBoxItem Content="16" Tag="16" IsSelected="True"/>
                        <ComboBoxItem Content="18" Tag="18"/>
                        <ComboBoxItem Content="20" Tag="20"/>
                        <ComboBoxItem Content="22" Tag="22"/>
                        <ComboBoxItem Content="24" Tag="24"/>
                        <ComboBoxItem Content="26" Tag="26"/>
                        <ComboBoxItem Content="28" Tag="28"/>
                        <ComboBoxItem Content="36" Tag="36"/>
                        <ComboBoxItem Content="48" Tag="48"/>
                        <ComboBoxItem Content="72" Tag="72"/>
                    </ComboBox>

                    <StackPanel Grid.Column="1" Height="22" Margin="6,5,0,0" Orientation="Horizontal" Grid.Row="1" VerticalAlignment="Top">
                        <!--Buttons-->
                        <Button x:Name="btnBold" Click="btnBold_Click" Margin="0,0,1,0">
                            <ToolTipService.ToolTip>
                                <ToolTip FontSize="16" Content="{Binding tooltip_Bold, Source={StaticResource localizedStrings}}"/>
                            </ToolTipService.ToolTip>
                            <Image Source="Images/Bold.png" d:IsLocked="True"/>
                        </Button>

                        <Button x:Name="btnItalic" Click="btnItalic_Click" Margin="0,0,1,0">
                            <ToolTipService.ToolTip>
                                <ToolTip FontSize="16" Content="{Binding tooltip_Italic, Source={StaticResource localizedStrings}}"/>
                            </ToolTipService.ToolTip>
                            <Image Source="Images/Italic.png"/>
                        </Button>

                        <Button x:Name="btnUnderline" Click="btnUnderline_Click" Margin="0,0,13,0">
                            <ToolTipService.ToolTip>
                                <ToolTip FontSize="16" Content="Underline"/>
                            </ToolTipService.ToolTip>
                            <Image Source="Images/Underline.png"/>
                        </Button>

                        <ComboBox x:Name="cmbFontColors" SelectionChanged="cmbFontColors_SelectionChanged" SelectedIndex="0" Margin="39,0,0,0" HorizontalAlignment="Right">
                            <ComboBoxItem Tag="FFFF0000">
                                <Rectangle Width="22" Height="14" Fill="Red" Margin="2,0,0,0" />
                            </ComboBoxItem>
                            <ComboBoxItem Tag="FF008000">
                                <Rectangle Width="22" Height="14" Fill="Green" Margin="2,0,0,0" />
                            </ComboBoxItem>
                            <ComboBoxItem Tag="FF0000FF">
                                <Rectangle Width="22" Height="14" Fill="Blue" Margin="2,0,0,0" />
                            </ComboBoxItem>
                            <ComboBoxItem Tag="FFFFFF00">
                                <Rectangle Width="22" Height="14" Fill="Yellow" Margin="2,0,0,0" />
                            </ComboBoxItem>
                            <ComboBoxItem Tag="FF000000" IsSelected="True">
                                <Rectangle Width="22" Height="14" Fill="Black" Margin="2,0,0,0" />
                            </ComboBoxItem>
                        </ComboBox>
                    </StackPanel>

                    <!--Buttons-->

                    <Button x:Name="btnImage" Click="btnImage_Click" HorizontalAlignment="Left" Grid.Column="2" Margin="13,-22,0,24" Grid.RowSpan="1" Grid.Row="1">
                        <ToolTipService.ToolTip>
                            <ToolTip FontSize="16" Content="{Binding tooltip_Image, Source={StaticResource localizedStrings}}"/>
                        </ToolTipService.ToolTip>
                        <Image Source="Images/Image.png" Height="32" Width="30"/>
                    </Button>
                    <Button x:Name="btnHyperlink" Click="btnHyperlink_Click" Grid.Column="2" Margin="55,-22,0,24" Grid.RowSpan="1" Grid.Row="1" HorizontalAlignment="Left">
                        <ToolTipService.ToolTip>
                            <ToolTip FontSize="16" Content="{Binding tooltip_Hyperlink, Source={StaticResource localizedStrings}}"/>
                        </ToolTipService.ToolTip>
                        <Image Source="Images/Hyperlink_big.png" Width="30" Height="32"/>
                    </Button>
                    <Button x:Name="btnTimestamp" Click="btnTimestamp_Click" Grid.Column="2" Grid.RowSpan="1" Margin="138,-22,0,24" HorizontalAlignment="Left" Grid.Row="1">
                        <ToolTipService.ToolTip>
                            <ToolTip FontSize="16" Content="{Binding tooltip_Timestamp, Source={StaticResource localizedStrings}}"/>
                        </ToolTipService.ToolTip>
                        <Image Source="Images/calendar.png" Width="29" Height="32"/>
                    </Button>
                    <Button x:Name="btnPrint" Click="btnPrint_Click" Grid.Column="3" Margin="20,-22,0,24" HorizontalAlignment="Left" Grid.Row="1">
                        <ToolTipService.ToolTip>
                            <ToolTip FontSize="16" Content="{Binding tooltip_Print, Source={StaticResource localizedStrings}}"/>
                        </ToolTipService.ToolTip>
                        <Image Source="Images/Print_big.png" Width="30"/>
                    </Button>
                    <ToggleButton x:Name="btnRTL" Checked="btnRTL_Checked" Unchecked="btnRTL_Checked" Grid.Column="4" Margin="15,-22,0,24" HorizontalAlignment="Left" Grid.Row="1">
                        <ToolTipService.ToolTip>
                            <ToolTip FontSize="16" Content="Text Direction"/>
                        </ToolTipService.ToolTip>
                        <Image Source="Images/ltr.png" Width="30"/>
                    </ToggleButton>
                    <ToggleButton x:Name="btnRO" Checked="btnRO_Checked" Unchecked="btnRO_Checked" Grid.Column="4" Margin="53,-22,0,24" HorizontalAlignment="Left" Grid.Row="1">
                        <ToolTipService.ToolTip>
                            <ToolTip FontSize="16" Content="Edit / View Mode"/>
                        </ToolTipService.ToolTip>
                        <Image Source="Images/edit.png" Width="29"/>
                    </ToggleButton>
                    <ToggleButton x:Name="btnHighlight" Checked="btnHighlight_Checked" Margin="17,-22,15,24" Grid.Column="5" Grid.Row="1" HorizontalAlignment="Left">
                        <ToolTipService.ToolTip>
                            <ToolTip FontSize="16" Content="Show Highlight"/>
                        </ToolTipService.ToolTip>
                        <Image Source="Images/Annotation_New.png"/>
                    </ToggleButton>
                    <ToggleButton x:Name="btnMarkUp" Checked="btnMarkUp_Checked" Unchecked="btnMarkUp_Checked" Margin="10,-22,10,24" Grid.Column="6" Grid.Row="1" HorizontalAlignment="Left">
                        <ToolTipService.ToolTip>
                            <ToolTip FontSize="16" Content="Show XAML"/>
                        </ToolTipService.ToolTip>
                        <TextBlock FontSize="25" Text="&lt;&lt;>>"/>
                    </ToggleButton>
                    <StackPanel Grid.RowSpan="1" Grid.Column="7" Margin="8" VerticalAlignment="Top" HorizontalAlignment="Right" Orientation="Horizontal" Grid.Row="1">
                        <!--New-->
                        <Button  x:Name="btnNew" Click="btnNew_Click" HorizontalAlignment="Left" Height="22" Margin="0,0,0,0" VerticalAlignment="Top" Width="22">
                            <ToolTipService.ToolTip>
                                <ToolTip FontSize="16" Content="{Binding tooltip_New, Source={StaticResource localizedStrings}}"/>
                            </ToolTipService.ToolTip>
                            <Image Source="Images/New.png"/>
                        </Button>
                        <!--Open Existing-->
                        <Button  x:Name="btnOpen" Click="btnOpen_Click" HorizontalAlignment="Left" Height="22" Margin="0,0,0,4" VerticalAlignment="Top" Width="22">
                            <ToolTipService.ToolTip>
                                <ToolTip FontSize="16" Content="{Binding tooltip_Open, Source={StaticResource localizedStrings}}"/>
                            </ToolTipService.ToolTip>
                            <Image Source="Images/Open.png"/>
                        </Button>
                        <!--Save Existing-->
                        <Button x:Name="btnSave" Click="btnSave_Click" HorizontalAlignment="Left" Height="22" VerticalAlignment="Top" Width="22">
                            <ToolTipService.ToolTip>
                                <ToolTip FontSize="16" Content="{Binding tooltip_Save, Source={StaticResource localizedStrings}}"/>
                            </ToolTipService.ToolTip>
                            <Image Source="Images/Save.png"/>
                        </Button>

                    </StackPanel>

                    <TextBlock Style="{StaticResource MenuLabel}" Text="{Binding txt_Clipboard, Source={StaticResource localizedStrings}}" Grid.Column="0" Grid.Row="1"/>
                    <TextBlock Style="{StaticResource MenuLabel}" Text="{Binding txt_Font, Source={StaticResource localizedStrings}}" Grid.Column="1" Grid.Row="1"/>
                    <TextBlock Style="{StaticResource MenuLabel}" Text="{Binding txt_Insert, Source={StaticResource localizedStrings}}" Grid.Column="2" Grid.Row="1"/>
                    <TextBlock Style="{StaticResource MenuLabel}" Text="{Binding txt_Print, Source={StaticResource localizedStrings}}" Grid.Column="3" Grid.Row="1"/>
                    <TextBlock Style="{StaticResource MenuLabel}" Text="{Binding txt_Display, Source={StaticResource localizedStrings}}" Grid.Column="4" Grid.Row="1"/>
                    <TextBlock Style="{StaticResource MenuLabel}" Text="{Binding txt_Highlight, Source={StaticResource localizedStrings}}" Grid.Column="5" Grid.Row="1"/>
                    <TextBlock Style="{StaticResource MenuLabel}" Text="{Binding txt_XAML, Source={StaticResource localizedStrings}}" Grid.Column="6" Grid.Row="1"/>
                    <TextBlock Style="{StaticResource MenuLabel}" Text="{Binding txt_File, Source={StaticResource localizedStrings}}" Grid.Column="7" Grid.Row="1"/>
                </Grid>
                <Grid Name="RTBGrid" Grid.Row="1">
                    <Rectangle Fill="White" Margin="0,1,1,0">
                        <Rectangle.Effect>
                            <DropShadowEffect ShadowDepth="1" Direction="371" BlurRadius="7" Opacity="0.345"/>
                        </Rectangle.Effect>
                    </Rectangle>
                    <RichTextBox x:Name="rtb" AllowDrop="True" BorderBrush="{x:Null}" Margin="8,10,0,8" MouseRightButtonDown="rtb_MouseRightButtonDown" MouseRightButtonUp="rtb_MouseRightButtonUp" Drop="rtb_Drop" MouseMove="rtb_MouseMove" DragEnter="rtb_DragEnter" DragLeave="rtb_DragLeave" TextWrapping="Wrap" Style="{StaticResource RichTextBoxStyle1}" VerticalScrollBarVisibility="Auto" FontSize="20" />
                    <Canvas x:Name="highlightCanvas" IsHitTestVisible="False" Margin="8,10,0,8"/>
                    <TextBox x:Name="xamlTb" IsTabStop="False" FontSize="20" FontFamily="Lucida Console" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" Visibility="Collapsed"/>
                </Grid>
            </Grid>
        </Border>
    </Grid>

</UserControl>
